<!DOCTYPE html>
<html lang="ja">
<head>
ã€€ã€€<link rel="manifest" href="manifest.json">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¨ˆç®—ã‚¯ã‚¤ã‚ºã‚²ãƒ¼ãƒ  (ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿)</title>

    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f7f6;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

        .container {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            width: 90%;
            max-width: 400px;
        }

        h1 {
            color: #333;
            margin-bottom: 20px;
        }

        /* ãƒ¢ãƒ¼ãƒ‰é¸æŠã‚¨ãƒªã‚¢ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        #mode-area {
            margin-bottom: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fff3cd; /* è–„ã„é»„è‰² */
        }

        #mode-select {
            padding: 8px;
            font-size: 1em;
            width: 100%;
            border: 1px solid #ccc;
            border-radius: 4px;
            margin-top: 5px;
        }

        #start-button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 1em;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            width: 100%;
            margin-top: 10px;
        }

        #start-button:hover {
            background-color: #0056b3;
        }

        /* ã‚¯ã‚¤ã‚ºã‚¨ãƒªã‚¢ã®ã‚¹ã‚¿ã‚¤ãƒ« (å¤‰æ›´ãªã—) */
        #quiz-area {
            margin-top: 20px;
        }

        #question {
            font-size: 2em;
            margin-bottom: 15px;
            color: #007bff;
            font-weight: bold;
        }

        #answer-input {
            padding: 10px;
            font-size: 1.2em;
            width: 80%;
            margin-bottom: 15px;
            border: 2px solid #ccc;
            border-radius: 5px;
            text-align: center;
        }

        #submit-button, #restart-button {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 1em;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            width: 100%;
            margin-top: 5px;
        }

        #submit-button:hover, #restart-button:hover {
            background-color: #218838;
        }

        #message {
            margin-top: 10px;
            font-weight: bold;
            min-height: 1.2em;
        }

        #result-area {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #e9ecef;
        }

        .hidden {
            display: none;
        }

        #score {
            font-size: 1.5em;
            color: #dc3545;
            font-weight: bold;
        }

        #current-question-count {
            margin-top: 20px;
            font-size: 1em;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 id="game-title">ğŸ”¢ è¨ˆç®—ã‚¯ã‚¤ã‚º</h1>
        
        <div id="mode-area">
            <label for="mode-select">ğŸš€ **ãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠ:**</label>
            <select id="mode-select">
                <option value="plus_2digit">â• 2æ¡ + 2æ¡</option>
                <option value="minus_2digit">â– 2æ¡ - 2æ¡</option>
                <option value="minus_2to1digit">â– 2æ¡ - 1æ¡</option>
            </select>
            <button id="start-button">ã‚²ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
        </div>
        
        <div id="quiz-area" class="hidden">
            <p id="question">å•é¡Œã‚’ç”Ÿæˆä¸­ã§ã™...</p>
            <input type="number" id="answer-input" placeholder="ç­”ãˆã‚’å…¥åŠ›" min="0" required>
            <button id="submit-button">å›ç­”</button>
            <p id="message"></p>
        </div>

        <div id="result-area" class="hidden">
            <h2>ğŸ‰ çµæœç™ºè¡¨</h2>
            <p id="score"></p>
            <button id="restart-button">ãƒ¢ãƒ¼ãƒ‰é¸æŠã«æˆ»ã‚‹</button>
        </div>

        <p id="current-question-count" class="hidden">1 / 10 å•ç›®</p>
    </div>

    <script>
        // å®šæ•°ã¨å¤‰æ•°ã®è¨­å®š
        const MAX_QUESTIONS = 10;
        const MIN_2DIGIT = 10;    
        const MAX_2DIGIT = 99;    
        const MIN_1DIGIT = 1;     
        const MAX_1DIGIT = 9;     

        let currentQuestion = 0;
        let score = 0;
        let correctAnswer = 0;
        let selectedMode = '';

        // DOMè¦ç´ ã®å–å¾—
        const gameTitle = document.getElementById('game-title');
        const modeArea = document.getElementById('mode-area');
        const modeSelect = document.getElementById('mode-select');
        const startButton = document.getElementById('start-button');
        const quizArea = document.getElementById('quiz-area');
        const resultArea = document.getElementById('result-area');
        const questionElement = document.getElementById('question');
        const answerInput = document.getElementById('answer-input');
        const submitButton = document.getElementById('submit-button');
        const messageElement = document.getElementById('message');
        const scoreElement = document.getElementById('score');
        const restartButton = document.getElementById('restart-button');
        const countElement = document.getElementById('current-question-count');

        // ãƒ©ãƒ³ãƒ€ãƒ ãªæ•°ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•° (minã‚’å«ã‚€ã€maxã‚’å«ã‚€)
        function generateRandomNumber(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        // ãƒ¢ãƒ¼ãƒ‰ã«åŸºã¥ã„ã¦å•é¡Œã®æ•°ã¨æ¼”ç®—å­ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°
        function generateQuestion(mode) {
            let num1, num2, operator, titleText;

            if (mode === 'plus_2digit') {
                // â• 2æ¡ + 2æ¡
                num1 = generateRandomNumber(MIN_2DIGIT, MAX_2DIGIT);
                num2 = generateRandomNumber(MIN_2DIGIT, MAX_2DIGIT);
                operator = '+';
                titleText = 'â• 2æ¡ + 2æ¡ ã‚¯ã‚¤ã‚º';
            } else if (mode === 'minus_2digit') {
                // â– 2æ¡ - 2æ¡ (ç­”ãˆãŒãƒã‚¤ãƒŠã‚¹ã«ãªã‚‰ãªã„ã‚ˆã†ã«)
                let numA = generateRandomNumber(MIN_2DIGIT, MAX_2DIGIT);
                let numB = generateRandomNumber(MIN_2DIGIT, MAX_2DIGIT);
                num1 = Math.max(numA, numB);
                num2 = Math.min(numA, numB);
                if (num1 === num2) num1++; // ç­”ãˆãŒ0ã«ãªã‚‰ãªã„ã‚ˆã†ã«
                operator = '-';
                titleText = 'â– 2æ¡ - 2æ¡ ã‚¯ã‚¤ã‚º';
            } else if (mode === 'minus_2to1digit') {
                // â– 2æ¡ - 1æ¡ (ç­”ãˆãŒãƒã‚¤ãƒŠã‚¹ã«ãªã‚‰ãªã„ã‚ˆã†ã«)
                num1 = generateRandomNumber(MIN_2DIGIT, MAX_2DIGIT);
                // num1ã‚ˆã‚Šå°ã•ãã€ã‹ã¤1æ¡ã®ç¯„å›²(1ï½9)ã§num2ã‚’ç”Ÿæˆ
                const maxSubtrahend = Math.min(num1 - 1, MAX_1DIGIT);
                num2 = generateRandomNumber(MIN_1DIGIT, maxSubtrahend);
                operator = '-';
                titleText = 'â– 2æ¡ - 1æ¡ ã‚¯ã‚¤ã‚º';
            }

            // æ­£è§£ã‚’è¨ˆç®—
            if (operator === '+') {
                correctAnswer = num1 + num2;
            } else if (operator === '-') {
                correctAnswer = num1 - num2;
            }
            
            // å•é¡Œæ–‡ã¨ã‚¿ã‚¤ãƒˆãƒ«ã‚’è¨­å®š
            questionElement.textContent = `${num1} ${operator} ${num2} = ?`;
            gameTitle.textContent = titleText;
        }

        // æ–°ã—ã„å•é¡Œã‚’è¨­å®šã™ã‚‹é–¢æ•°
        function setNextQuestion() {
            currentQuestion++;

            if (currentQuestion > MAX_QUESTIONS) {
                showResult();
                return;
            }

            // ã‚«ã‚¦ãƒ³ãƒˆè¡¨ç¤ºã‚’æ›´æ–°
            countElement.textContent = `${currentQuestion} / ${MAX_QUESTIONS} å•ç›®`;

            // å•é¡Œã‚’ç”Ÿæˆ
            generateQuestion(selectedMode);

            // å…¥åŠ›æ¬„ã‚’ã‚¯ãƒªã‚¢
            answerInput.value = '';
            messageElement.textContent = '';
            answerInput.focus();
        }

        // å›ç­”ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹é–¢æ•°
        function checkAnswer() {
            const userAnswer = parseInt(answerInput.value, 10);

            if (isNaN(userAnswer)) {
                messageElement.textContent = 'âš ï¸ æ•°å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
                messageElement.style.color = '#ffc107';
                answerInput.focus();
                return;
            }

            if (userAnswer === correctAnswer) {
                score++;
                messageElement.textContent = 'â­•ï¸ æ­£è§£ã§ã™ï¼';
                messageElement.style.color = '#28a745';
            } else {
                messageElement.textContent = `âŒ ä¸æ­£è§£ã§ã™ã€‚ï¼ˆæ­£è§£: ${correctAnswer}ï¼‰`;
                messageElement.style.color = '#dc3545';
            }

            submitButton.disabled = true;
            answerInput.disabled = true;

            setTimeout(() => {
                submitButton.disabled = false;
                answerInput.disabled = false;
                setNextQuestion();
            }, 800);
        }

        // çµæœã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
        function showResult() {
            quizArea.classList.add('hidden');
            countElement.classList.add('hidden');
            resultArea.classList.remove('hidden');
            
            scoreElement.textContent = `${MAX_QUESTIONS}å•ä¸­ã€${score}å•æ­£è§£ã—ã¾ã—ãŸï¼`;
            
            if (score === MAX_QUESTIONS) {
                scoreElement.textContent += ' ç´ æ™´ã‚‰ã—ã„ï¼å…¨å•æ­£è§£ã§ã™ï¼ğŸ’¯';
            } else if (score >= MAX_QUESTIONS * 0.7) {
                scoreElement.textContent += ' ã‚ˆãã§ãã¾ã—ãŸï¼ğŸ‘';
            } else {
                scoreElement.textContent += ' ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼ğŸ’ª';
            }
        }

        // ã‚²ãƒ¼ãƒ ã‚’åˆæœŸåŒ–ã—ã¦ãƒ¢ãƒ¼ãƒ‰é¸æŠç”»é¢ã«æˆ»ã‚‹
        function resetToModeSelection() {
            gameTitle.textContent = 'ğŸ”¢ è¨ˆç®—ã‚¯ã‚¤ã‚º';
            modeArea.classList.remove('hidden');
            quizArea.classList.add('hidden');
            resultArea.classList.add('hidden');
            countElement.classList.add('hidden');
            messageElement.textContent = '';
            // å¤‰æ•°ã‚’ãƒªã‚»ãƒƒãƒˆ
            currentQuestion = 0;
            score = 0;
        }

        // ã‚²ãƒ¼ãƒ ã‚’é–‹å§‹ã™ã‚‹é–¢æ•°
        function startGame() {
            selectedMode = modeSelect.value;

            // ãƒ¢ãƒ¼ãƒ‰é¸æŠç”»é¢ã‚’éè¡¨ç¤ºã«ã—ã€ã‚¯ã‚¤ã‚ºç”»é¢ã‚’è¡¨ç¤º
            modeArea.classList.add('hidden');
            quizArea.classList.remove('hidden');
            countElement.classList.remove('hidden');
            
            // ã‚²ãƒ¼ãƒ é–‹å§‹
            currentQuestion = 0;
            score = 0;
            setNextQuestion();
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        startButton.addEventListener('click', startGame);
        submitButton.addEventListener('click', checkAnswer);
        restartButton.addEventListener('click', resetToModeSelection);

        // Enterã‚­ãƒ¼ã§ã®å›ç­”é€ä¿¡
        answerInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !submitButton.disabled) {
                checkAnswer();
            }
        });

        // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã®åˆæœŸè¨­å®š
        window.onload = resetToModeSelection;
    </script>
</body>
</html>